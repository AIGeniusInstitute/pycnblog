
# K-Means - 原理与代码实例讲解

> 关键词：K-Means, 聚类算法, 数据聚类, 机器学习, 随机算法, K值选择, 算法效率

## 1. 背景介绍

聚类是一种无监督学习方法，旨在将数据集划分为若干个组或簇，使得同一簇内的数据点彼此相似，而不同簇的数据点彼此不同。K-Means聚类算法是应用最广泛的聚类算法之一，由于其简单易用和高效的特性，被广泛用于数据挖掘、图像处理、市场分析等领域。本文将深入讲解K-Means算法的原理、操作步骤、代码实现以及实际应用场景。

## 2. 核心概念与联系

### 2.1 K-Means算法的核心概念

K-Means算法的核心概念包括：

- **数据点**：构成数据集的每个个体，通常表示为一个多维向量。
- **簇**：数据点的一个分组，同一簇内的数据点相似度高，不同簇的数据点相似度低。
- **簇中心**：簇内所有数据点的平均位置，用于表示簇的特征。
- **K值**：需要划分的簇的数量。

### 2.2 K-Means算法的架构

以下为K-Means算法的基本架构流程：

```mermaid
graph LR
A[数据集] --> B{选择K值}
B -->|随机选择| C{初始化簇中心}
C --> D{计算每个数据点到簇中心的距离}
D --> E{分配数据点至最近的簇中心}
E --> F{计算新的簇中心}
F -->|重复| B
```

## 3. 核心算法原理 & 具体操作步骤

### 3.1 算法原理概述

K-Means算法的基本原理如下：

1. **选择K值**：确定要划分的簇的数量。
2. **初始化簇中心**：随机选择K个数据点作为初始簇中心。
3. **计算距离**：计算每个数据点到每个簇中心的距离。
4. **分配数据点**：将每个数据点分配到最近的簇中心。
5. **计算簇中心**：计算每个簇内所有数据点的平均位置，作为新的簇中心。
6. **重复步骤3-5**：重复计算距离、分配数据点和计算簇中心，直到簇中心不再变化或达到预设的迭代次数。

### 3.2 算法步骤详解

1. **初始化**：
   - 选择K个数据点作为初始簇中心。
   - 可以使用随机选择、K-means++算法等策略进行初始化。

2. **迭代优化**：
   - 对每个数据点，计算其到每个簇中心的距离。
   - 将每个数据点分配到最近的簇中心，形成新的簇分配。
   - 计算每个簇内所有数据点的平均位置，作为新的簇中心。

3. **收敛判断**：
   - 检查簇中心是否发生变化，如果变化很小，则算法收敛。
   - 或者达到预设的迭代次数后，算法停止。

### 3.3 算法优缺点

**优点**：

- 算法简单易实现。
- 运算速度快，适合大规模数据集。
- 对初始簇中心的选择不敏感。

**缺点**：

- 必须预先指定簇的数量（K值）。
- 对噪声和异常值敏感，可能导致聚类效果不佳。
- 可能收敛到局部最优解。

### 3.4 算法应用领域

K-Means算法在以下领域有广泛的应用：

- 数据挖掘：聚类分析、异常检测、客户细分等。
- 图像处理：图像分割、目标检测等。
- 生物信息学：基因表达分析、蛋白质结构预测等。
- 金融分析：信用风险评估、市场细分等。

## 4. 数学模型和公式 & 详细讲解 & 举例说明

### 4.1 数学模型构建

K-Means算法的数学模型如下：

- 设数据集为 $X = \{x_1, x_2, ..., x_n\}$，其中 $x_i$ 是一个 $d$ 维向量。
- 设簇中心为 $C = \{c_1, c_2, ..., c_k\}$，其中 $c_j$ 是一个 $d$ 维向量。
- 设数据点 $x_i$ 属于簇 $c_j$，则 $x_i \in C_j$。

### 4.2 公式推导过程

K-Means算法的目标是最小化所有数据点到其对应簇中心的距离平方和：

$$
J(C) = \sum_{i=1}^n \sum_{j=1}^k \sum_{x_i \in C_j} \|x_i - c_j\|^2
$$

其中 $\|x_i - c_j\|^2$ 表示数据点 $x_i$ 到簇中心 $c_j$ 的欧几里得距离平方。

### 4.3 案例分析与讲解

假设有一个二维数据集，包含10个数据点，如下所示：

```
0.1 0.2
0.1 0.2
0.3 0.4
0.4 0.5
0.5 0.4
0.5 0.5
0.7 0.7
0.8 0.6
0.8 0.8
0.9 0.9
```

使用K-Means算法将其聚类成2个簇，K值选择为2。初始化簇中心为(0.5, 0.5)和(0.8, 0.8)。以下是算法的迭代过程：

1. **第一次迭代**：
   - 计算每个数据点到簇中心的距离，并进行分配。
   - 簇中心更新为(0.2, 0.2)和(0.8, 0.8)。
   
2. **第二次迭代**：
   - 计算每个数据点到簇中心的距离，并进行分配。
   - 簇中心更新为(0.1, 0.1)和(0.9, 0.9)。
   
3. **第三次迭代**：
   - 计算每个数据点到簇中心的距离，并进行分配。
   - 簇中心保持不变为(0.1, 0.1)和(0.9, 0.9)。

最终，数据点被成功聚类成2个簇。

## 5. 项目实践：代码实例和详细解释说明

### 5.1 开发环境搭建

- 安装Python：从Python官网下载并安装最新版本的Python。
- 安装NumPy和SciPy：使用pip安装NumPy和SciPy库，用于数值计算和科学计算。
- 安装Matplotlib：使用pip安装Matplotlib库，用于数据可视化。

### 5.2 源代码详细实现

```python
import numpy as np
import matplotlib.pyplot as plt

# K-Means算法实现
def k_means(X, K, max_iters=100):
    # 初始化簇中心
    centroids = X[np.random.choice(range(X.shape[0]), K, replace=False)]
    # 初始化簇分配
    clusters = np.zeros(X.shape[0])
    for _ in range(max_iters):
        # 计算每个数据点到簇中心的距离
        distances = np.sqrt(((X - centroids[:, np.newaxis])**2).sum(axis=2))
        # 分配数据点到最近的簇
        clusters = np.argmin(distances, axis=0)
        # 更新簇中心
        centroids = np.array([X[clusters == k].mean(axis=0) for k in range(K)])
    return clusters, centroids

# 加载数据
X = np.array([[0.1, 0.2], [0.1, 0.2], [0.3, 0.4], [0.4, 0.5], [0.5, 0.4],
              [0.5, 0.5], [0.7, 0.7], [0.8, 0.6], [0.8, 0.8], [0.9, 0.9]])

# 聚类
clusters, centroids = k_means(X, 2)

# 可视化结果
plt.scatter(X[:, 0], X[:, 1], c=clusters)
plt.scatter(centroids[:, 0], centroids[:, 1], s=300, c='red', marker='x')
plt.show()
```

### 5.3 代码解读与分析

上述代码实现了一个简单的K-Means算法。首先定义了k_means函数，该函数接受数据集X、簇的数量K和最大迭代次数max_iters作为参数。函数内部首先随机初始化簇中心，然后进入迭代过程，计算每个数据点到簇中心的距离，进行数据点的分配，并更新簇中心。最终返回聚类结果clusters和簇中心centroids。

接下来，加载数据并调用k_means函数进行聚类。最后，使用Matplotlib库将聚类结果可视化，并用红色标记簇中心。

### 5.4 运行结果展示

运行上述代码后，将得到以下可视化结果：

```
^
|
|      *      *      *      *      *      *      *      *      *      *
|               *             *             *
|                      *                     *
|             *                                 *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|    *                                           *
|